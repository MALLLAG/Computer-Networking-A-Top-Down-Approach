# 2.1 네트워크 애플리케이션의 원리

## 네트워크 응용 프로그램 개발의 핵심 개념

새로운 네트워크 응용 프로그램 아이디어가 있다고 가정해봅시다. <br>
네트워크 응용 프로그램 개발의 핵심은 여러 다양한 단말 장치에서 실행될 수 있는 프로그램을 작성하고, 이들이 네트워크를 통해 통신하며 서비스를 제공하는 것입니다. <br>
예를 들어, 웹 응용 프로그램은 두 개의 서로 다른 응용 프로그램 간의 통신을 포함합니다. 하나는 사용자의 장치에서 실행되는 브라우저이고, 다른 하나는 서비스를 제공하는 서버에서 실행되는 프로그램입니다. <br>
이 두 프로그램은 서로 다르게 생겼습니다. 반면, P2P 파일 전송 응용 프로그램은 파일 공유 커뮤니티 내의 각 컴퓨터에서 실행되며, 파일 전송 방법을 알고 있는 동일한 프로그램입니다.

즉, 새로운 네트워크 응용 프로그램을 개발할 때의 핵심은 다양한 단말 장치에서 실행될 수 있는 프로그램을 작성하는 것입니다. <br>
네트워크 코어(라우터, 스위치 등)에서 실행되는 프로그램을 작성할 필요는 없습니다. 실제로 작성할 수도 없습니다. 왜냐하면 이 장비들은 응용 계층이 아닌 더 하위의 네트워크 계층에서 동작하는 프로토콜을 실행하기 때문입니다. <br>
이런 기본 설계 덕분에 응용 프로그램은 단말 장치에서만 동작하며, 이로 인해 네트워크 응용 프로그램의 개발과 배포가 더 빠르고 다양해질 수 있습니다.

<img width="704" height="808" alt="Image" src="https://github.com/user-attachments/assets/ed17bcd6-e310-4874-97ac-6b985c85045c" />

---

## 2.1.1 네트워크 응용 아키텍처

프로그래밍을 시작하기 전에, 자신이 만들 프로그램의 아키텍처에 대한 개념이 필요합니다. <br>
여기서 말하는 응용 프로그램 아키텍처는 네트워크 프로토콜의 5계층 구조(네트워크 아키텍처)가 아닙니다. <br>
응용 프로그램 개발자에게 네트워크 아키텍처는 이미 정해져 있으며, 필요한 인터페이스와 기능을 제공합니다. <br>
우리가 말하는 응용 프로그램 아키텍처란, 소프트웨어 개발자가 직접 설계하여, 서로 다른 단말 시스템에 배포된 프로그램들이 어떻게 통신할지 결정하는 구조입니다. <br>
현대 네트워크 응용 프로그램은 주로 클라이언트-서버 아키텍처 또는 P2P(피어 투 피어) 아키텍처 중 하나를 사용합니다.

<img width="741" height="508" alt="Image" src="https://github.com/user-attachments/assets/5c3ad46c-6d18-4d84-906c-0510ef289373" />

### 클라이언트-서버 아키텍처

클라이언트-서버 아키텍처에서는 항상 꺼지지 않는 서버(서버)가 존재하며, 이 서버는 다른 컴퓨터(클라이언트)에서 오는 요청을 지속적으로 처리합니다. <br>
대표적인 예로 웹 서비스가 있습니다. 웹 서버는 여러 클라이언트의 브라우저에서 오는 요청을 지속적으로 처리합니다.

- 클라이언트끼리는 직접 통신하지 않습니다. (예: 웹 브라우저들끼리는 직접 메시지를 주고받지 못함)
- 서버는 변하지 않는, 모두가 알고 있는 IP 주소를 가져야 합니다.
- 클라이언트는 언제든 서버의 주소로 패킷을 보낼 수 있습니다.
- 대표적인 서비스: 웹 서비스, FTP, Telnet, 이메일 등

클라이언트-서버 아키텍처의 문제는 단일 서버가 모든 클라이언트의 요청을 처리하지 못할 수 있다는 것입니다. 대규모 트래픽을 처리하려면 데이터 센터(수많은 서버로 구성된 강력한 가상 서버)를 사용합니다. 구글, 페이스북, 아마존 등은 여러 데이터 센터를 보유하고 있습니다.

### P2P(피어 투 피어) 아키텍처

P2P 아키텍처에서는 데이터가 전용 서버를 거치지 않고, 직접 연결된 여러 컴퓨터(피어) 사이에서 전송됩니다. 피어들은 일반 사용자의 컴퓨터 또는 노트북 등으로, 가정, 학교, 직장 등 다양한 곳에 존재합니다.

- 데이터 전송이 서버를 거치지 않고 직접 이루어집니다.
- 대표적인 P2P 서비스: 파일 전송(BitTorrent), P2P 다운로드 가속기, 인터넷 전화, 화상회의 등
- 일부 서비스는 하이브리드 구조를 사용(예: 메신저 서비스는 서버로 IP만 추적하고, 메시지는 직접 주고받음)
- P2P의 가장 큰 특징은 ‘자체 확장성(self-scalability)’입니다. 즉, 피어가 많아질수록 시스템 용량도 늘어납니다.
- 하지만 보안, 성능, 신뢰성 측면에서는 문제점이 있습니다. 왜냐하면 구조가 매우 분산되어 있기 때문입니다.

---

## 2.1.2 프로세스 간 통신

응용 프로그램 아키텍처 외에도, 서로 다른 장치에 배포된 프로그램들이 어떻게 통신하는지 이해해야 합니다. <br>
같은 컴퓨터 내의 프로세스는 OS가 제공하는 IPC(프로세스 간 통신)로 해결하면 되지만, 여기서는 서로 다른 컴퓨터(다른 OS일 수도 있음)에서 실행되는 프로세스 간 통신에 집중합니다.

서로 다른 단말 장치에서 실행되는 두 프로세스는 네트워크를 통해 메시지(message)를 주고받아야 합니다. 한 프로세스는 메시지를 네트워크로 보내고, 다른 프로세스는 메시지를 받아서 필요하다면 응답 메시지를 다시 보냅니다.

### 클라이언트와 서버 프로세스

네트워크 응용 프로그램은 네트워크를 통해 메시지를 주고받는 프로세스 쌍으로 구성됩니다. 일반적으로 두 프로세스는 클라이언트와 서버로 나뉩니다. <br>
P2P 구조에서도 한 컴퓨터가 클라이언트이자 서버일 수 있습니다. 하지만 통신 세션(session)에서는 다음과 같이 구분합니다.

- 통신을 먼저 시작하는 쪽(요청을 보내는 쪽)이 클라이언트
- 기다렸다가 응답하는 쪽이 서버

<img width="743" height="369" alt="Image" src="https://github.com/user-attachments/assets/b50a3eda-de4f-48a2-9384-d5668cbeec4b" />

예시:
- 웹 서비스: 브라우저(클라이언트)가 서버에 요청을 보냄. 서버는 응답함.
- 파일 공유: Peer A가 Peer B에게 파일을 요청하면, A가 클라이언트, B가 서버

### 프로세스와 컴퓨터 네트워크 간의 인터페이스

네트워크 응용 프로그램 간 메시지 전송에 사용되는 인터페이스를 소켓(socket)이라고 합니다. <br>
응용 프로그램은 집, 소켓은 집의 문, 네트워크는 우편 시스템에 비유할 수 있습니다. 송신자는 메시지를 문 밖으로 내보내고, 네트워크(우편배달부)가 이를 수신자에게 전달합니다. 수신자도 문을 통해 메시지를 받습니다.

소켓은 응용 계층과 전송 계층 사이의 인터페이스이자, 응용 프로그래밍 인터페이스(API)입니다. <br>
개발자는 소켓의 응용 계층 부분을 완전히 제어할 수 있지만, 전송 계층 쪽은 제한적으로만 제어할 수 있습니다(전송 프로토콜 선택, 버퍼 크기 등 일부 매개변수 조정). 전송 프로토콜이 정해지면, 해당 프로토콜이 제공하는 기능만 사용할 수 있습니다.

### 프로세스 주소 지정

편지를 보내려면 받는 사람의 주소가 필요하듯, 컴퓨터도 메시지를 보낼 때 수신 프로세스의 주소를 알아야 합니다.

- (1) 수신 측 호스트의 주소 (IP 주소)
- (2) 수신 측 호스트 내에서 해당 프로세스를 식별하는 식별자(포트 번호)

IP 주소: 인터넷상의 모든 호스트를 식별하는 32비트 식별자. 한 호스트에 여러 응용 프로그램이 실행될 수 있으므로, 포트 번호로 각 프로세스(정확히는 소켓)를 구분합니다. 유명한 서비스들은 고정 포트 번호를 사용합니다(웹 80, 이메일 25 등).

---

## 2.1.3 응용이 이용할 수 있는 전송 서비스

소켓은 응용 프로그램과 전송 계층 사이의 인터페이스입니다. 응용 프로그램이 메시지를 소켓에 보내면, 전송 계층이 이를 수신 측 소켓까지 전달해야 합니다. <br>
많은 네트워크(인터넷 포함)는 여러 전송 계층 프로토콜을 제공합니다. 개발자는 응용에 맞는 프로토콜을 골라야 합니다. 각 프로토콜이 제공하는 서비스(신뢰성, 속도, 보안 등)를 보고 선택합니다.

### 전송 서비스의 네 가지 측면

1. **신뢰성(신뢰할 수 있는 데이터 전송)**  
   패킷이 손실될 수 있으므로, 일부 서비스(예: 인터넷 뱅킹)는 반드시 데이터가 정확히 전달되어야 합니다. 이런 기능을 제공하는 프로토콜은 ‘신뢰성’을 제공합니다. 신뢰성이 없는 프로토콜을 사용하는 경우, 일부 데이터 손실이 허용됩니다(예: 음성/영상 통화에서 약간의 손실은 큰 문제 아님).

2. **처리량(Throughput)**  
   네트워크 대역폭은 여러 프로그램이 공유하며, 시간에 따라 변동됩니다. 어떤 서비스는 최소 처리량을 보장해야 정상적으로 동작합니다(예: 인터넷 전화는 32kbps 필요). 이런 서비스를 ‘대역폭 민감 응용’이라고 합니다. 반면, 웹 서비스, 이메일 등은 처리량에 크게 민감하지 않습니다(‘탄력적 응용’).

3. **지연(Timing)**  
   일부 서비스는 전송 지연이 중요합니다(예: 인터넷 전화, 온라인 게임, VR 등). 실시간 서비스에서는 지연이 너무 길면 사용성에 문제가 생깁니다.

4. **보안(Security)**  
   전송 계층 프로토콜은 데이터 암호화, 무결성, 엔드포인트 인증 등 보안 서비스를 제공할 수 있습니다.

---

## 2.1.4 인터넷이 제공하는 전송 서비스

실제 인터넷(TCP/IP)에는 두 가지 주요 전송 서비스가 있습니다: **UDP**와 **TCP**. 응용 프로그램 개발자는 둘 중 하나를 선택해야 하며, 각 프로토콜이 제공하는 서비스가 다릅니다.

| 응용 서비스          | 패킷 손실 허용 | 처리량 요구 | 지연 요구           |
|--------------------|--------------|-----------|-------------------|
| 파일 전송/다운로드    | 불가           | 없음        | 없음                |
| 이메일               | 불가           | 없음        | 없음                |
| 웹 서비스            | 불가           | 없음(고정)  | 없음                |
| 인터넷 전화/화상회의    | 가능           | 음성: 수 kbps~1Mbps<br>영상: 10kbps~5Mbps | 100ms 이하           |
| 미디어 스트리밍        | 가능           | 위와 같음    | 수 초 이내           |
| 인터랙티브 게임        | 가능           | 수 kbps~10kbps | 100ms 이하           |
| 스마트폰 채팅 서비스    | 불가           | 없음        | 경우에 따라 다름(?)    |

### TCP 서비스

- **연결 지향적 서비스**: 통신 시작 전, 양쪽이 제어 정보를 교환(핸드셰이킹)하여 연결을 성립시킵니다. 연결이 성립되면 양쪽 모두 동시에 메시지를 주고받을 수 있습니다.
- **신뢰성 있는 데이터 전송**: 모든 데이터가 정확히, 순서대로 전달됨을 보장합니다.
- **혼잡 제어**: 네트워크 혼잡 시 송신 측의 전송량을 제한하여 네트워크 안정성 유지.

#### TCP의 보안 강화

TCP와 UDP는 기본적으로 암호화를 제공하지 않습니다. 따라서 민감한 정보를 전송하면 노출 위험이 있습니다. <br>
이를 보완하기 위해 SSL(Secure Sockets Layer)과 같은 보안 프로토콜이 개발되었습니다. SSL은 TCP 위에서 동작하며, 데이터 암호화, 무결성, 엔드포인트 인증을 제공합니다.

### UDP 서비스

UDP는 매우 기본적인, 경량화된 전송 프로토콜입니다.

- **비연결형**: 송신 전 별도의 연결 설정(핸드셰이킹) 없이 바로 데이터 전송
- **신뢰성 없음**: 데이터 손실, 순서 뒤바뀜이 발생할 수 있음
- **혼잡 제어 없음**: 송신 속도에 제한이 없음(네트워크 상황에 따라 실제 처리량은 다름)

### 인터넷 전송 프로토콜이 제공하지 않는 서비스

TCP와 UDP는 신뢰성, 보안(SSL 추가 시) 등은 제공하지만, 처리량 보장이나 지연 보장은 제공하지 않습니다. 실시간 서비스들은 이런 환경에서도 동작하도록 설계되어 있지만, 한계가 있습니다.

| 응용 서비스      | 응용 계층 프로토콜    | 하위 전송 계층 프로토콜 |
|----------------|-------------------|--------------------|
| 이메일           | SMTP [RFC 5321]   | TCP                |
| 원격 터미널 접속    | Telnet [RFC 854]   | TCP                |
| 웹 서비스         | HTTP [RFC 2616]   | TCP                |
| 파일 전송         | FTP [RFC 959]     | TCP                |
| 미디어 스트리밍     | HTTP(예: 유튜브)   | TCP                |
| 인터넷 전화        | SIP, RTP, Skype 등 | UDP 또는 TCP        |

---

## 2.1.5 응용 계층 프로토콜

응용 프로그램이 소켓을 통해 메시지를 주고받을 수 있더라도, 메시지의 형식과 의미, 전송 시점 등은 응용 계층 프로토콜이 정합니다. 응용 계층 프로토콜은 다음을 정의합니다.

- 메시지의 종류(예: 요청, 응답)
- 메시지의 형식(필드와 구조)
- 각 필드의 의미
- 메시지 전송 및 응답 규칙

일부 응용 계층 프로토콜은 RFC에 공개되어 누구나 사용할 수 있습니다(예: HTTP). 반면, Skype와 같은 일부는 독점 프로토콜입니다.

‘네트워크 응용 서비스’와 ‘응용 계층 프로토콜’은 다릅니다. 예를 들어, 웹 서비스는 HTML, 브라우저, 웹 서버, HTTP 프로토콜 등 여러 요소로 구성되며, HTTP는 그 중 하나(하지만 매우 중요한 부분)입니다. 이메일 서비스도 마찬가지로 여러 요소와 SMTP 프로토콜로 구성됩니다.

---

## 2.1.6 이 책에서 다루는 네트워크 응용

매일 새로운 네트워크 응용 서비스가 개발되고 있습니다. 이 책에서는 다음의 다섯 가지 주요 응용 프로그램에 집중합니다.

1. **웹 서비스**: 가장 흔하며, HTTP 프로토콜이 매우 직관적임
2. **이메일**: 인터넷의 첫 ‘킬러 서비스’로, 여러 응용 계층 프로토콜 사용
3. **DNS**: 인터넷의 ‘전화번호부’ 역할. 사용자는 직접 사용하지 않지만 필수적인 서비스
4. **P2P 파일 전송**
5. **미디어 스트리밍 서비스**: CDN(콘텐츠 전송 네트워크)을 활용한 영상 전송 포함.