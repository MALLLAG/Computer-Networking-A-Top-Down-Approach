## 5.7 네트워크 관리(Network Management)와 SNMP, NETCONF/YANG

이제 네트워크 계층의 학습을 마무리하면서, 우리는 네트워크가 수많은 하드웨어와 소프트웨어 요소들이 상호 작용하는 복잡한 시스템임을 잘 알고 있습니다.  
링크, 스위치, 라우터, 호스트 등 다양한 장치들이 물리적 네트워크를 구성하며, 이들을 제어하고 조정하는 여러 프로토콜들이 존재합니다.  
수백, 수천 개의 장치가 하나의 네트워크를 이루면, 이를 “항상 정상적으로 운영되게(up and running)” 유지하는 것은 네트워크 관리자에게 큰 도전 과제입니다.

섹션 5.5에서 보았듯이, **SDN(Software Defined Networking)** 의 중앙 집중식 컨트롤러가 이 과정을 도울 수 있습니다.  
그러나 네트워크 관리는 SDN 이전부터 존재해왔으며, 네트워크를 모니터링하고 관리하며 제어하기 위한 다양한 **관리 도구와 접근 방식**이 발전해왔습니다.  
이번 절에서는 이러한 전통적인 네트워크 관리 도구뿐 아니라 SDN과 함께 진화한 새로운 기술들도 함께 다룹니다.

### 네트워크 관리(Network Management)란?

자주 묻는 질문 중 하나는 “네트워크 관리란 무엇인가?”입니다.  
이에 대한 대표적인 정의([Saydam 1996])는 다음과 같습니다.

> **“네트워크 관리는 네트워크와 그 구성 요소의 실시간 운영 성능과 품질 보장(QoS) 요구사항을 합리적인 비용으로 충족하기 위해, 하드웨어, 소프트웨어, 그리고 인적 요소를 배포, 통합, 조정하여 네트워크 및 요소 자원을 모니터링, 테스트, 구성, 분석, 평가, 제어하는 활동을 포함한다.”**

이 정의에 따라, 본 절에서는 네트워크 관리의 기초적인 구조(architecture), 프로토콜, 데이터에 대해 다룹니다.

## 5.7.1 네트워크 관리 프레임워크 (Network Management Framework)

아래 그림(Figure 5.20)은 네트워크 관리의 핵심 구성 요소를 보여줍니다.

<img width="528" height="490" alt="Image" src="https://github.com/user-attachments/assets/8e039097-3b72-445d-bc8a-10868fca581c" />

### Managing Server (관리 서버)
관리 서버는 **네트워크 관리 애플리케이션**으로, 일반적으로 **네트워크 관리자(network manager)** 가 중앙 집중식 관리 스테이션(NOC: Network Operations Center)에서 운영합니다.  
이 서버는 네트워크 관리의 중심으로, **관리 정보의 수집, 처리, 분석, 그리고 명령 전송(dispatching)** 을 수행합니다.  
즉, 네트워크의 장치들을 **구성(configure), 모니터링(monitor), 제어(control)** 하는 모든 명령이 이곳에서 시작됩니다.  
실제 환경에서는 여러 개의 관리 서버가 존재할 수도 있습니다.

### Managed Device (관리 대상 장치)
관리 대상 장치는 네트워크 상에서 동작하는 장비(및 그 소프트웨어)로, 호스트, 라우터, 스위치, 모뎀, 미들박스 등 다양한 형태가 있습니다.  
각 장치는 여러 관리 가능한 구성 요소를 가지며, 예를 들어 라우터의 인터페이스 설정, 내부 라우팅 프로토콜(OSPF 등)의 매개변수 등을 포함합니다.

### Data (데이터)
각 관리 장치는 상태(state) 데이터를 보유합니다. 주요 데이터 유형은 다음과 같습니다.

- **Configuration Data (구성 데이터)**: 네트워크 관리자가 직접 설정한 정보(IP 주소, 인터페이스 속도 등)
- **Operational Data (운영 데이터)**: 장치가 동작 중 수집한 정보(예: OSPF 인접 라우터 목록)
- **Device Statistics (장치 통계)**: 장치 상태 및 동작 카운터(예: 손실된 패킷 수, 팬 속도 등)

관리 서버는 이러한 데이터를 질의하거나, 원격 장치의 값을 수정하여 제어할 수 있습니다.

### Network Management Agent (네트워크 관리 에이전트)
에이전트는 **관리 대상 장치 내에서 동작하는 소프트웨어 프로세스**로, 관리 서버와 통신하며 명령을 수행합니다.  
에이전트는 관리 서버의 지시에 따라 장치를 모니터링하거나 제어합니다.  
이는 앞서 배운 라우팅 에이전트와 유사한 구조를 가집니다.

### Network Management Protocol (네트워크 관리 프로토콜)
마지막 구성 요소는 **네트워크 관리 프로토콜**로, 관리 서버와 관리 대상 장치 간의 통신을 담당합니다.  
이 프로토콜을 통해 관리 서버는 장치의 상태를 질의하고 명령을 전달할 수 있습니다.  
또한 에이전트는 장치 오류나 성능 저하 등의 예외적인 이벤트를 서버로 보고합니다.

중요한 점은, 이 프로토콜이 직접 네트워크를 “관리”하지는 않는다는 것입니다.  
대신 관리자가 네트워크를 **모니터링, 테스트, 구성, 분석, 제어**할 수 있도록 기능을 제공합니다.

## 네트워크 관리 방식

실무에서 네트워크 관리자는 다음 세 가지 방식으로 네트워크를 관리합니다.

### CLI (Command Line Interface)
네트워크 운영자는 장치 콘솔이나 원격 SSH/Telnet 연결을 통해 **CLI 명령어**를 직접 입력하여 제어할 수 있습니다.  
이 방식은 장치 제조사별로 명령 체계가 다르고, 자동화가 어렵다는 단점이 있습니다.  
작은 규모의 장치에서는 효과적일 수 있지만, 대규모 네트워크에서는 비효율적입니다.

### SNMP / MIB
**SNMP(Simple Network Management Protocol)** 방식에서는 네트워크 운영자가 **MIB(Management Information Base)** 객체를 통해 장치의 데이터를 조회하거나 수정합니다.  
MIB에는 장치의 다양한 통계 정보가 저장되어 있으며, SNMP 프로토콜로 이를 읽거나 쓸 수 있습니다.  
이 방법은 1980년대 후반부터 사용되어 왔지만, 대규모 네트워크 구성 및 관리에는 한계가 있습니다.

### NETCONF / YANG
**NETCONF/YANG**은 최근 등장한 방식으로, **네트워크 전반의 통합적이고 구조화된 관리 접근법**을 제공합니다.  
특히 **구성 관리(configuration management)** 에 중점을 두고 있으며, 여러 장치에 대한 일관된 원자적(atomic) 관리 작업을 지원합니다.

- **YANG**([RFC 6020])은 **데이터 모델링 언어**로, 구성 및 운영 데이터를 모델링하기 위해 사용됩니다.
- **NETCONF**([RFC 6241])는 YANG 모델을 기반으로 **원격 장치 간의 데이터 교환 및 명령 수행**을 지원하는 프로토콜입니다.

NETCONF/YANG은 네트워크 관리의 현대적 표준으로 자리 잡고 있으며, SDN 환경에서도 적극적으로 활용됩니다.









## 5.7.2 단순 네트워크 관리 프로토콜 (SNMP)과 관리 정보 베이스 (MIB)

**SNMP (Simple Network Management Protocol)** 버전 3 (SNMPv3) [RFC 3410]은 관리 서버와 그 서버를 대신하여 동작하는 에이전트 간에 네트워크 관리 제어 및 정보 메시지를 전달하기 위한 **응용 계층 프로토콜**입니다.  
가장 일반적인 사용 방식은 **요청-응답(request-response)** 형태로, 관리 서버가 에이전트에 요청을 보내면 에이전트가 응답하는 구조입니다.

일반적으로 요청은 관리 장치(예: 라우터, 스위치 등)에 저장된 **MIB 객체 값**을 조회(get)하거나 수정(set)하는 데 사용됩니다.  
또한 SNMP는 에이전트가 관리 서버에 **Trap 메시지(비동기적 알림)** 를 보내는 방식도 지원합니다.  
이 메시지는 링크 업/다운과 같은 예외 상황이 발생했을 때 관리 서버에 즉시 통보하기 위해 사용됩니다.

### MIB와 SMI

MIB 객체는 **SMI(Structure of Management Information)** 라는 데이터 기술 언어로 정의됩니다 [RFC 2578, 2579, 2580].  
SMI는 네트워크 관리 데이터의 문법과 의미를 명확하게 하기 위한 언어이며, 관련 MIB 객체들은 **MIB 모듈**로 묶여 있습니다.  
2019년 기준 400개 이상의 표준 MIB 모듈이 정의되어 있으며, 수많은 벤더 전용(private) MIB도 존재합니다.

### SNMPv3의 PDU 유형

SNMPv3는 **PDU(Protocol Data Unit)** 라고 불리는 7가지 유형의 메시지를 정의합니다.

| SNMPv3 PDU Type | 송수신 방향 | 설명 |
|-----------------|--------------|------|
| GetRequest | manager → agent | 하나 이상의 MIB 객체 값을 요청 |
| GetNextRequest | manager → agent | 다음 MIB 객체 값을 요청 |
| GetBulkRequest | manager → agent | 테이블 형태의 대용량 데이터를 요청 |
| InformRequest | manager ↔ manager | 다른 관리 서버에게 MIB 정보를 알림 |
| SetRequest | manager → agent | 하나 이상의 MIB 객체 값을 설정 |
| Response | agent → manager | 위 요청들에 대한 응답 |
| SNMPv2-Trap | agent → manager | 예외 이벤트를 관리 서버에 알림 |

### SNMP PDU 형식

SNMP PDU는 **요청 헤더**와 **변수(데이터 바인딩) 부분**으로 구성됩니다.

| PDU Type (0–3) | Request ID | Error Status | Error Index | Name | Value | ... |
|----------------|-------------|---------------|--------------|------|-------|-----|

Trap 메시지의 경우에는 다음과 같은 필드를 가집니다.

| PDU Type (4) | Enterprise | Agent Addr | Trap Type | Specific Code | Timestamp | Name | Value |
|---------------|-------------|-------------|-------------|---------------|-----------|------|-------|

### SNMP 메시지 종류별 설명

- **GetRequest / GetNextRequest / GetBulkRequest**  
  관리 서버가 MIB 객체 값을 요청합니다.  
  `GetRequest`는 특정 객체, `GetNextRequest`는 다음 객체, `GetBulkRequest`는 대량 데이터를 효율적으로 가져올 때 사용됩니다.

- **SetRequest**  
  관리 서버가 하나 이상의 MIB 객체 값을 수정할 때 사용합니다.  
  에이전트는 성공 시 “noError” 상태로 응답합니다.

- **InformRequest**  
  한 관리 서버가 다른 관리 서버에 MIB 정보를 알릴 때 사용합니다.

- **Response**  
  에이전트가 요청에 응답할 때 사용합니다.

- **Trap**  
  비정상 상태나 이벤트 발생 시 에이전트가 관리 서버로 즉시 알림을 보냅니다.  
  예: 장치 부팅, 링크 다운, 인증 실패 등. (RFC 3418 정의)

### SNMP 전송 방식 및 신뢰성

SNMP PDU는 여러 전송 프로토콜을 사용할 수 있지만, 일반적으로 **UDP를 기본 전송 계층**으로 사용합니다 [RFC 3417].  
UDP는 비신뢰성(unreliable) 프로토콜이므로, 요청이나 응답이 손실될 수 있습니다.  
SNMP는 재전송 메커니즘을 강제하지 않으며, **재전송 여부와 주기를 관리 서버가 스스로 결정**해야 합니다.

### SNMP의 발전

SNMP는 세 가지 주요 버전을 거쳐 발전했습니다.

- **SNMPv1:** 초기 버전, 보안 기능이 거의 없음
- **SNMPv2:** 기능 확장 (GetBulk, InformRequest 등 추가)
- **SNMPv3:** 보안 및 인증 기능 강화 (암호화, 접근 제어 포함)

SNMPv3는 본질적으로 SNMPv2에 **보안과 관리 기능을 추가한 버전**으로 볼 수 있습니다.

## 관리 정보 베이스 (MIB)

MIB는 네트워크 장치의 운영 상태나 구성 상태 데이터를 객체 형태로 정의한 데이터베이스입니다.  
예를 들어 다음과 같은 정보들이 MIB 객체로 저장됩니다.

- 라우터에서 폐기된 IP 데이터그램 수
- 이더넷 인터페이스의 오류 발생 횟수
- DNS 서버의 실행 중인 소프트웨어 버전
- 특정 장치의 동작 여부
- 특정 경로의 라우팅 정보 등

MIB 객체는 모듈 단위로 관리되며, 다음과 같은 RFC들이 표준 MIB를 정의합니다.

- [RFC 4293] IP 및 ICMP용 MIB
- [RFC 4022] TCP용 MIB
- [RFC 4113] UDP용 MIB


## 5.7.3 네트워크 구성 프로토콜 (NETCONF)과 YANG

**NETCONF**는 관리 서버와 관리 대상 장치 간의 네트워크 구성 데이터를 송수신하기 위한 **응용 계층 프로토콜**입니다.  
이를 통해 관리 서버는 다음과 같은 작업을 수행할 수 있습니다.

1. **구성 데이터의 조회, 설정, 수정**
2. **운영 데이터 및 통계 정보 질의**
3. **장치 알림(notification) 구독**

NETCONF는 XML 기반의 **RPC(Remote Procedure Call)** 형식을 사용하여 메시지를 주고받습니다.  
이 통신은 일반적으로 **TLS(Transport Layer Security)** 기반의 안전한 TCP 세션 위에서 이루어집니다.

### NETCONF 세션 구조

NETCONF 세션의 흐름은 다음과 같습니다.

1. **Session Initiation (세션 시작)**:  
   관리 서버와 장치가 `<hello>` 메시지를 교환하며 기능(capability)을 선언함.

2. **RPC 통신**:  
   `<rpc>` 요청과 `<rpc-reply>` 응답을 통해 데이터 조회 및 설정 수행.

3. **Notification (알림)**:  
   장치에서 관리 서버로 이벤트 알림 전송.

4. **Session Close**:  
   `<close-session>` 메시지로 세션 종료.

### 주요 NETCONF 연산

| NETCONF Operation | 설명 |
|-------------------|------|
| `<get-config>` | 지정된 구성 데이터를 조회. 장치는 여러 구성 상태(running 등)를 가질 수 있음. |
| `<get>` | 구성 및 운영 데이터를 모두 조회. |
| `<edit-config>` | 장치의 설정을 변경. 실패 시 롤백 가능. |
| `<lock>`, `<unlock>` | 구성 데이터 저장소를 잠그거나 해제. |
| `<create-subscription>`, `<notification>` | 알림 이벤트를 구독 및 전달. |


### YANG

YANG은 NETCONF에서 사용하는 데이터 모델링 언어로, 네트워크 관리 데이터의 구조, 구문, 의미를 명확히 정의하기 위해 사용됩니다.  
이는 SNMP에서 SMI가 MIB를 정의하는 방식과 유사합니다.

모든 YANG 정의는 모듈(module) 단위로 구성됩니다.  
YANG은 기본 데이터 타입을 제공하며, 제약 조건(constraint)과 일관성(consistency)을 표현할 수 있습니다.
NETCONF 구성이 올바른지 검증하고, NETCONF 알림(notification) 정의에도 사용됩니다.  
