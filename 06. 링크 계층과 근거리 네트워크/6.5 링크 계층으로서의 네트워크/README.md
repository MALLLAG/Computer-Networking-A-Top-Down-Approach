# 6.5 링크 가상화: 링크 계층으로서의 네트워크

## 개요

이 장에서는 링크 계층 프로토콜을 다루면서 "링크(link)"라는 용어의 이해가 어떻게 발전해왔는지 살펴본다.

### 링크의 개념 변화

| 관점 | 링크의 의미 |
|------|------------|
| **초기 관점** | 두 통신 호스트를 연결하는 물리적 와이어 |
| **다중 접속 프로토콜** | 공유된 와이어나 무선 스펙트럼과 같은 채널 |
| **이더넷 LAN** | 복잡한 스위치 인프라로 구성된 상호연결 매체 |

### 인터넷의 가상화

- **다이얼업 모뎀 연결**: 두 호스트를 연결하는 링크가 실제로는 전화망(자체 스위치, 링크, 프로토콜 스택을 가진 별도의 글로벌 통신 네트워크)
- **인터넷 링크 계층 관점**: 전화망을 통한 다이얼업 연결은 단순한 "와이어"로 간주
- **인터넷의 가상화**: 전화망을 두 인터넷 호스트 간의 링크 계층 연결을 제공하는 링크 계층 기술로 가상화

> 오버레이 네트워크가 인터넷을 오버레이하듯이, 인터넷은 전화망을 오버레이한다.

### 링크 계층 기술로서의 네트워크

다음 네트워크들은 IP 장치를 상호연결하는 링크 계층 기술로 간주될 수 있다:
- **MPLS** (Multiprotocol Label Switching)
- **스위치 이더넷**
- **프레임 릴레이** (Frame-relay)
- **ATM 네트워크**

---

## 6.5.1 다중 프로토콜 레이블 스위칭 (MPLS)

### MPLS의 배경

- **등장 시기**: 1990년대 중후반
- **목표**: 고정 길이 레이블을 사용하여 IP 라우터의 포워딩 속도 향상
- **핵심 개념**: 목적지 기반 IP 데이터그램 포워딩 인프라를 버리지 않고, 고정 길이 레이블과 가상 회선 개념을 접목

### MPLS의 특징

| 특징 | 설명 |
|------|------|
| **패킷 스위칭** | 회선 교환 전화망과 달리 패킷 스위칭 방식의 가상 회선 네트워크 |
| **자체 패킷 형식** | 독자적인 패킷 형식과 포워딩 동작 보유 |
| **IP와의 연동** | IP 주소 지정 및 라우팅과 함께 작동 |

### MPLS 헤더 구조

<img width="546" height="190" alt="Image" src="https://github.com/user-attachments/assets/585c6bc5-b656-428c-9f5f-2a90db2d153b" />

**MPLS 헤더**: 링크 계층 헤더와 네트워크 계층 헤더 사이에 위치

### MPLS 헤더 필드

| 필드 | 설명 |
|------|------|
| **Label** | MPLS 레이블 (포워딩에 사용) |
| **Exp** | 실험용으로 예약된 3비트 |
| **S** | "스택된" MPLS 헤더의 끝을 나타내는 단일 비트 |
| **TTL** | Time-to-Live 필드 |

### 레이블 스위치 라우터 (Label-Switched Router)

- **MPLS 강화 프레임**: MPLS 지원 라우터 간에만 전송 가능
- **비MPLS 라우터의 혼란**: IP 헤더를 기대했는데 MPLS 헤더를 발견하면 혼란
- **레이블 스위치 라우터**: MPLS 지원 라우터의 별칭
  - 포워딩 테이블에서 MPLS 레이블을 조회
  - 해당 출력 인터페이스로 데이터그램을 즉시 전달
  - **목적지 IP 주소 추출 불필요**: 최장 접두사 매칭 수행 필요 없음

### MPLS 포워딩 테이블 구조

| in label | out label | dest | out interface |
|----------|-----------|------|---------------|
| 입력 레이블 | 출력 레이블 | 목적지 | 출력 인터페이스 |

### MPLS 포워딩 예제

<img width="529" height="352" alt="Image" src="https://github.com/user-attachments/assets/aa2d83ef-8b7f-40f6-a639-87359d5e4326" />

**예제 설명**:
- **R1~R4**: MPLS 지원 라우터
- **R5, R6**: 표준 IP 라우터
- **R1의 광고**: R2, R3에게 목적지 A로 라우팅 가능하며, MPLS 레이블 6으로 포워딩됨을 알림
- **R3의 광고**: R4에게 목적지 A, D로 라우팅 가능하며, 각각 MPLS 레이블 10, 12로 스위칭됨을 알림
- **R2의 광고**: R4에게 목적지 A로 라우팅 가능하며, MPLS 레이블 8로 스위칭됨을 알림

### MPLS 인프라의 역할

- IP 장치 R5, R6, A, D가 MPLS 인프라(R1~R4)를 통해 연결
- **스위치 LAN이나 ATM 네트워크처럼** IP 장치를 연결
- **핵심**: MPLS 라우터 R1~R4는 **패킷의 IP 헤더를 전혀 건드리지 않고** 포워딩 수행

---

## MPLS 시그널링 및 경로 계산

### 레이블 분배 프로토콜

- **RSVP-TE** [RFC 3209]: RSVP 프로토콜의 확장
- IETF의 MPLS 워킹 그룹에서 MPLS 시그널링의 핵심으로 지정 [RFC 3468]

### 경로 계산

- MPLS 지원 라우터 간 경로 계산 방법은 별도로 논의되지 않음
- **기존 링크 상태 라우팅 알고리즘 확장**: OSPF 등이 MPLS 라우터에 정보를 플러딩하도록 확장
- **표준화되지 않은 경로 계산**: 실제 경로 계산 알고리즘은 벤더별로 다름

---

## MPLS의 진정한 장점

### 트래픽 엔지니어링 (Traffic Engineering)

| IP 라우팅 | MPLS |
|-----------|------|
| 단일 최소 비용 경로만 지정 | 동일 목적지로의 여러 경로 지원 |

**예제**: R4는 목적지 A로의 두 가지 MPLS 경로 보유
- 인터페이스 0을 통해 MPLS 레이블 10으로
- 인터페이스 1을 통해 MPLS 레이블 8로

**트래픽 엔지니어링의 활용** [RFC 3346; RFC 3272; RFC 2702]:
- 네트워크 운영자가 일반 IP 라우팅을 오버라이드
- 특정 목적지로 향하는 트래픽의 일부를 한 경로로
- 나머지 트래픽을 다른 경로로 강제 (정책, 성능 또는 기타 이유로)

### 빠른 경로 복구

- **링크 장애 대응**: 미리 계산된 페일오버 경로를 통해 트래픽을 빠르게 재라우팅
- [Kar 2000; Huang 2002; RFC 3469]

### 가상 사설망 (VPN)

- **VPN 구현**: ISP가 MPLS 네트워크를 사용하여 고객의 여러 네트워크를 연결
- **자원 및 주소 격리**: MPLS를 통해 고객 VPN의 자원과 주소를 다른 사용자로부터 격리
- [DeClercq 2002] 참조

---

## MPLS와 SDN의 관계

### 역사적 맥락

- MPLS는 소프트웨어 정의 네트워킹(SDN, 5장) 개발 이전에 부상
- MPLS의 많은 트래픽 엔지니어링 기능은 SDN과 일반화된 포워딩 패러다임(4장)으로도 달성 가능

### 미래 전망

- MPLS와 SDN이 공존할 것인지
- SDN과 같은 새로운 기술이 MPLS를 대체할 것인지

> 미래만이 MPLS와 SDN의 관계를 알려줄 것이다.
